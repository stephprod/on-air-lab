<% include header %>
	
  		
    <section class="short-image no-padding blog-short-title">
		<div class="container">
			<div class="row">
				<div class="col-xs-12 col-lg-12 short-image-title">
					<h5 class="subtitle-margin second-color">Tableau de bord</h5>
					<h1 class="second-color">mon agenda</h1>
					<div class="short-title-separator"></div>
				</div>
			</div>
		</div>
    </section>
	
	<section class="section-light section-top-shadow">
		<div class="container">
			<div class="row">
				<div class="col-xs-12 col-md-3 col-md-push-1">
					<div class="sidebar-left">
						<h3 class="sidebar-title">Bon retour parmis nous<span class="special-color">.</span></h3>
						<div class="title-separator-primary"></div>
						
						<div class="profile-info margin-top-60">
							<div class="profile-info-title negative-margin"><%= locals.session.userFirstName %> <%= locals.session.userName %></div>
							<img src="<%= locals.etabObj !== undefined ? locals.etabObj[0].path_img : '/asset/content/img/default_pro_profile.jpeg' %>" alt="" class="pull-left" />
							<div class="profile-info-text pull-left">
								<p class="subtitle-margin">
									<% if (locals.session.userType == 2){ %> 
										Professionnel Audio
									<% }else if(locals.session.userType == 3){ %>
										Professionnel Vidéo
									<% }else{ %>
										Administrateur
									<% } %>
								</p>
								
								<a href="#logout-modal" class="logout-link margin-top-30" data-toggle="modal"><i class="fas fa-lg fa-sign-out-alt"></i>Se déconnecter</a>
							</div>
							<div class="clearfix"></div>
						</div>
						<div class="center-button-cont margin-top-30">
							<a href="/upload-files" class="button-primary button-shadow button-full">
								<span>Mes documents</span>
								<div class="button-triangle"></div>
								<div class="button-triangle2"></div>
								<div class="button-icon"><i class="fa fa-th-list"></i></div>
							</a>
						</div>
						<div class="center-button-cont margin-top-15">
							<a href="/info-pro" class="button-primary button-shadow button-full">
								<span>Mon profile</span>
								<div class="button-triangle"></div>
								<div class="button-triangle2"></div>
								<div class="button-icon"><i class="fa fa-user"></i></div>
							</a>
						</div>
						<div class="title-separator-primary"></div>
						<div class="center-button-cont margin-top-15">
							<a href="#pro-payment-modal" data-toggle="modal" class="button-primary button-shadow button-full">
								<span>Mes abonnements</span>
								<div class="button-triangle"></div>
								<div class="button-triangle2"></div>
								<div class="button-icon"><i class="fa fa-th-list"></i></div>
							</a>
						</div>
						<div class="center-button-cont margin-top-15">
							<a href="#" id="redirectAdmin" class="button-alternative button-shadow button-full">
								<span>Une reclamation</span>
								<div class="button-triangle"></div>
								<div class="button-triangle2"></div>
								<div class="button-icon"><i class="jfont fa-lg">&#xe804;</i></div>
							</a>
						</div>
						
					</div>
				</div>
				<div class="col-xs-12 col-md-9 col-md-push-1">
					<div data-name="global_msg"></div>
					<div class="col-xs-12 margin-top-60">
						<h3 class="title-negative-margin">Mon agenda<span class="special-color">.</span></h3>
						<div class="title-separator-primary"></div>
					</div>
						<div id='wrap'>
						<div id='external-events'>
							<div class="datepicker labelled-input-short">
								<span>Horaire d'ouverture</span>
								<div class="clearfix"></div>
								<label for="open">
										<i class="fas fa-door-open icon-social porte-ouverte"></i>
								</label>
								<input id="open" name="ouverture" type="text" class="input-full main-input" placeholder="" value=""/>
								<div class="clearfix"></div>
							</div>
							<div class="datepicker labelled-input-short">
								<span>Horaire de fermeture</span>
								<div class="clearfix"></div>
								<label for="close">
										<i class="fas fa-door-closed icon-social porte-ferme"></i>
								</label>
								<input id="close" name="fermeture" type="text" class="input-full main-input" placeholder="" value=""/>
								<div class="clearfix"></div>
							</div>
						    <p><strong>pour les jours suivants :</strong></p>
							<div class="boxes dark-col">
							  <input type="checkbox" id="lundi">
							  <label for="lundi">Lundi</label>

							  <input type="checkbox" id="mardi">
							  <label for="mardi">Mardi</label>

							  <input type="checkbox" id="mercredi">
							  <label for="mercredi">Mercredi</label>

							  <input type="checkbox" id="jeudi">
							  <label for="jeudi">Jeudi</label>

							  <input type="checkbox" id="vendredi">
							  <label for="vendredi">Vendredi</label>

							  <input type="checkbox" id="samedi">
							  <label for="samedi">Samedi</label>

							  <input type="checkbox" id="dimanche">
							  <label for="dimanche">Dimanche</label>
							</div>
						    <p><strong>pause du midi ou fermeture exeptionnelle de :</strong></p>
							<div class="datepicker">
								<input name="pausedeb" type="text" class="input-full main-input" placeholder="" value=""/>
								<div class="clearfix"></div>
							</div>
						    <p><strong>A :</strong></p>
							<div class="datepicker">
								<input name="pausefin" type="text" class="input-full main-input" placeholder="" value=""/>
								<div class="clearfix"></div>
							</div>
						</div>
						<div id='calendar'></div>
						<div id="dishoraire" class="col-md-9">
							<p class="horaire-align"><strong>Mes horaires :</strong></p>
						<div class="center-button-cont margin-top-15">
							<a href="#" class="savecal button-alternative button-shadow button-full">
								<span>Sauvegarder</span>
								<div class="button-triangle"></div>
								<div class="button-triangle2"></div>
								<div class="button-icon"><i class="jfont fa-lg">&#xe804;</i></div>
							</a>
						</div>
						</div>
						<div style='clear:both'></div>
						</div>
				</div>
					</form>
					<div class="row margin-top-60"></div>
				</div>			
			</div>
		</div>
	</section>
	<footer class="small-cont">
		<div class="container">
			<div class="row">
				<div class="col-xs-12 col-md-6 small-cont">
					<img src="images/logo-light.png" alt="" class="img-responsive footer-logo" />
				</div>
				<div class="col-xs-12 col-md-6 footer-copyrights">
					&copy; Copyright 2015 <a href="http://themeforest.net/user/johnnychaos?ref=johnnychaos" target="blank">Jan Skwara</a>. All rights reserved. Buy on <a href="http://themeforest.net/user/johnnychaos/portfolio?ref=johnnychaos" target="blank">Themeforest</a>.
				</div>
			</div>
		</div>
	</footer>
</div>	

<!-- Move to top button -->

<div class="move-top">
	<div class="big-triangle-second-color"></div>
	<div class="big-icon-second-color"><i class="jfont fa-lg">&#xe803;</i></div>
</div>	

<!-- Login modal -->
	<div class="modal fade apartment-modal" id="login-modal">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-body">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
					<div class="modal-title login-msg">
						<h1>Login<span class="special-color">.</span></h1>
						<div class="short-title-separator"></div>
					</div>
					<input name="login" type="email" class="input-full main-input" placeholder="Email" />
					<input name="password" type="password" class="input-full main-input" placeholder="Your Password" />
					<a href="my-profile.html" class="button-primary button-shadow button-full">
						<span>Sing In</span>
						<div class="button-triangle"></div>
						<div class="button-triangle2"></div>
						<div class="button-icon"><i class="fa fa-user"></i></div>
					</a>
					<a href="#" class="forgot-link pull-right">Forgot your password?</a>
					<div class="clearfix"></div>
					<p class="login-or">OR</p>
					<a href="#" class="facebook-button">
						<i class="fa fa-facebook"></i>
						<span>Login with Facebook</span>
					</a>
					<a href="#" class="google-button margin-top-15">
						<i class="fa fa-google-plus"></i>
						<span>Login with Google</span>
					</a>
					<p class="modal-bottom">Don't have an account? <a href="#" class="register-link">REGISTER</a></p>
				</div>
			</div><!-- /.modal-content -->
		</div><!-- /.modal-dialog -->
	</div><!-- /.modal -->

<!-- Register modal -->
	<div class="modal fade apartment-modal" id="register-modal">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-body">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
					<div class="modal-title">
						<h1>Register<span class="special-color">.</span></h1>
						<div class="short-title-separator"></div>
					</div>
					<input name="first-name" type="text" class="input-full main-input" placeholder="Frist name" />
					<input name="last-name" type="text" class="input-full main-input" placeholder="Last name" />
					<input name="email" type="email" class="input-full main-input" placeholder="Email" />
					<input name="password" type="password" class="input-full main-input" placeholder="Password" />
					<input name="repeat-password" type="password" class="input-full main-input" placeholder="Repeat Password" />
					<a href="my-profile.html" class="button-primary button-shadow button-full">
						<span>Sing up</span>
						<div class="button-triangle"></div>
						<div class="button-triangle2"></div>
						<div class="button-icon"><i class="fa fa-user"></i></div>
					</a>
					<div class="clearfix"></div>
					<p class="login-or">OR</p>
					<a href="#" class="facebook-button">
						<i class="fa fa-facebook"></i>
						<span>Sing Up with Facebook</span>
					</a>
					<a href="#" class="google-button margin-top-15">
						<i class="fa fa-google-plus"></i>
						<span>Sing Up with Google</span>
					</a>
					<p class="modal-bottom">Already registered? <a href="#" class="login-link">SING IN</a></p>
				</div>
			</div><!-- /.modal-content -->
		</div><!-- /.modal-dialog -->
	</div><!-- /.modal -->

<!-- Logout modal -->
	<div class="modal fade apartment-modal" id="logout-modal">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-body">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
					<div class="modal-title logout-msg">
						<h1>Déconnexion<span class="special-color">.</span></h1>
						<div class="short-title-separator"></div>
					</div>
					<a data-action="logout" href="#" class="button-primary button-shadow button-full">
						<span>Se déconnecter</span>
						<div class="button-triangle"></div>
						<div class="button-triangle2"></div>
						<div class="button-icon"><i class="fa fa-user"></i></div>
					</a>
				</div>
			</div><!-- /.modal-content -->
		</div><!-- /.modal-dialog -->
	</div><!-- /.modal -->

<!-- Forgotten password modal -->
	<div class="modal fade apartment-modal" id="forgot-modal">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-body">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
					<div class="modal-title">
						<h1>Forgot your password<span class="special-color">?</span></h1>
						<div class="short-title-separator"></div>
					</div>
					<p class="negative-margin forgot-info">Instert your account email address.<br/>We will send you a link to reset your password.</p>
					<input name="login" type="email" class="input-full main-input" placeholder="Your email" />
					<a href="my-profile.html" class="button-primary button-shadow button-full">
						<span>Reset password</span>
						<div class="button-triangle"></div>
						<div class="button-triangle2"></div>
						<div class="button-icon"><i class="fa fa-user"></i></div>
					</a>
				</div>
			</div><!-- /.modal-content -->
		</div><!-- /.modal-dialog -->
	</div><!-- /.modal -->

<!-- jQuery  -->
    <script type="text/javascript" src="/asset/js/jQuery/jquery.min.js"></script>
	<script type="text/javascript" src="/asset/js/jQuery/jquery-ui.min.js"></script>
	
<!-- Bootstrap-->
    <script type="text/javascript" src="/asset/js/bootstrap.min.js"></script>

<!-- Google Maps -->
	<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key=AIzaSyDfDCV5hXiPamCIT8_vwGXuzimLQ9MF76g&amp;sensor=false&amp;libraries=places"></script>
	
<!-- plugins script -->
	<script type="text/javascript" src="/asset/js/plugins.js"></script>

<!-- template scripts -->
	<script type="text/javascript" src="/asset/mail/validate.js"></script>
    <script type="text/javascript" src="/asset/js/apartment.js"></script>
    <script type="module" src="/asset/js/logout.js"></script>
	<script src='/asset/js/fullcalendar/moment.min.js'></script>
	<script src='/asset/js/locale/fr.js'></script>
	<script src='/asset/js/fullcalendar/fullcalendar.min.js'></script>
	    <!-- Bootstrap Date time picker -->
	<script language="javascript" src="/asset/js/bootstrap-datetimepicker.js"></script>
<script>

			var lundi;
			var mardi;
			var mercredi;
			var jeudi;
			var vendredi;
			var samedi;
			var dimanche;
			var pause;

    /*  className colors
    
    className: default(transparent), important(red), chill(pink), success(green), info(blue)
    
    */
      
    /* initialize the external events
    -----------------------------------------------------------------*/
  
    $('#external-events div.external-event').each(function() {
    
      // create an Event Object (http://arshaw.com/fullcalendar/docs/event_data/Event_Object/)
      // it doesn't need to have a start or end
      var eventObject = {
        title: $.trim($(this).text()) // use the element's text as the event title
      };
      
      // store the Event Object in the DOM element so we can get to it later
      var t = $(this).data('eventObject', eventObject);
      
      // make the event draggable using jQuery UI
      $(this).draggable({
        zIndex: 999,
        revert: true,      // will cause the event to go back to its
        revertDuration: 0  //  original position after the drag
      });
      
    });
   
    /* initialize the calendar
    -----------------------------------------------------------------*/
    
    var calendar =  $('#calendar').fullCalendar({
      header: {
        left: 'title',
        center: 'agendaDay,agendaWeek,month',
        right: 'prev,next today'
      },
      slotLabelFormat:"HH:mm",
      editable: true,
      firstDay: 1, //  1(Monday) this can be changed to 0(Sunday) for the USA system
      selectable: true,
      defaultView: 'agendaWeek',
      axisFormat: 'h:mm',
      locale: 'fr', // AJOUTER LE FICHIER LOCALS src='fullcalendar/lang-all.js
      eventLimit: true, // for all non-agenda views
      views: {
        agenda: {
          eventLimit: 4 // adjust to 6 only for agendaWeek/agendaDay
        },
      },  	
      selectHelper: true,
      selectConstraint: "businessHours",
		select: function(start, end, allDay) {
		 var title = prompt('Event Title:');
		 if (title) {
			 start = start.format();
			 end = end.format();
			$.ajax({
				url: '/agenda',
				data: 'title='+ title+'&start='+ start +'&end='+ end ,
				type: "POST",
				success: function(data) {
					calendar.fullCalendar('renderEvent',
						{
							id_event : data[4],
							title: title,
							start: start,
							end: end,
						},
						true // make the event "stick"
					);
				}
			});
		}
		calendar.fullCalendar('unselect');
	},
      eventClick: function(event, jsEvent, view) {
        console.log('Clicked on: ' + event.start.format()+' A : ' + event.end.format());
        console.log('Clicked on: ' + event.title);
        console.log('Clicked on: ' + event.id_event);

        // console.log('Coordinates: ' + jsEvent.id + ',' + jsEvent.pageY);

        // console.log('Current view: ' + view.name);

        // change the day's background color just for fun
		$(this).css('background-color', '#e9e9e9');
			var result = confirm('ete vous sur de vouloir supprimer l\'evenement ?');
			if(result){
				$('#calendar').fullCalendar('removeEvents', event._id);
				$.ajax({
						url: '/drop_event_calendar',
						data: 'id='+event.id_event,
						type: "POST",
						beforeSend: function(req){
							req.setRequestHeader("x-access-token", session.token);
						},
						success: function(data) {
							console.log("Event "+data+" Mit à la poubelle");
						}
					})
			}
		},
      droppable: true, // this allows things to be dropped onto the calendar !!!
      dragRevertDuration: 0,
      eventDrop: function(event, date, allDay) { // this function is called when something is dropped
      
        //retrieve the dropped element's stored Event Object
        var originalEventObject = $(this).data('eventObject');
        
        // we need to copy it, so that multiple events don't have a reference to the same object
        var copiedEventObject = $.extend({}, originalEventObject);
        
        // assign it the date that was reported
        copiedEventObject.start = date;
        copiedEventObject.allDay = allDay;
        // render the event on the calendar
        // the last `true` argument determines if the event "sticks" (http://arshaw.com/fullcalendar/docs/event_rendering/renderEvent/)
        
        // is the "remove after drop" checkbox checked?
        if ($('#drop-remove').is(':checked')) {
          // if so, remove the element from the "Draggable Events" list
          $(this).remove();
        }
        
      },
		  eventDrop: function(event, delta, revertFunc) {
		  	var start = event.start.format();
		  	var end = event.end.format();
		    alert(event.title + " was dropped on " + event.start.format());

		    if (!confirm("Are you sure about this change?")) {
		    	revertFunc();
		    }
		    else{
			 $.ajax({
				 url: '/update_event_calendar',
				 data: 'start='+ start +'&end='+ end+'&id='+ event.id_event,
				 beforeSend: function(req){
					req.setRequestHeader("x-access-token", "<%- locals.session.token %>");
				},
				 type: "POST",
				 success: function(data) {
					console.log("Update de "+data.id);
				 }
			 });
		    }
		  },
      eventResize: function(event, delta, revertFunc, jsEvent, ui, view){
        var start = event.start.format();
        var end = event.end.format();
        alert(event.title + " was resized on " + event.end.format());
        if (!confirm("Are you sure about this change?")) {
          revertFunc();
        }
        else{
         $.ajax({
           url: '/update_event_calendar',
		   data: 'start='+ start +'&end='+ end+'&id='+ event.id_event,
		   beforeSend: function(req){
				req.setRequestHeader("x-access-token", "<%- locals.session.token %>");
			},
           type: "POST",
           success: function(data) {
           		console.log("Update de "+data.id);
           		
           }
         });
        }
      },
		//A ACTIVER EN EJS
	    businessHours: <%- locals.dow %>,
		events: <%- locals.eventObj %>
    });
	    $('.datepicker input').datetimepicker({
	    	format : 'HH:mm',
	    	locale : 'fr',
	    	sideBySide : true,
	    	stepping : 30
	    });
	    //console.log($('.datepicker input').data("DateTimePicker").disable());
	    $('.datepicker input').on("dp.change", function(e){
	    	var target = $(e.target);
	    	var val_open = $('.datepicker input#open').val().replace(":", ".");
	    	var val_close =  $('.datepicker input#close').val().replace(":", ".");
	    	//console.log(target);
	    	if (target.attr("id") == "close"){
	    		if ($('.datepicker input#open').val() != ""){
	    			if (parseFloat(val_open) < parseFloat(val_close))
	    				$('input[type=checkbox]').removeAttr("disabled", "disabled");		
	    		}
	    	}else{
	    		if ($('.datepicker input#close').val() != ""){
	    			if (parseFloat(val_open) < parseFloat(val_close))
	    				$('input[type=checkbox]').removeAttr("disabled", "disabled");		
	    		}
	    	}
	    	//console.log("CHANGE FIRED !");
	    });
		$('input[type=checkbox]').attr("disabled", "disabled");
		$('input[type=checkbox]').change(function(e){
		    if($(this).is(':checked')) {
		        //console.log("Checked" +e.target.id);
				$("<p class='horaire-align' id="+e.target.id+">"+e.target.id+" : de "+$('input[name="ouverture"]').val()+" A "+$('input[name="fermeture"]').val()+"</p>").appendTo( "#dishoraire" );
				if (e.target.id == "lundi") {
					lundi = $('input[name="ouverture"]').val()+"-"+$('input[name="fermeture"]').val();
				}if (e.target.id == "mardi") {
					mardi = $('input[name="ouverture"]').val()+"-"+$('input[name="fermeture"]').val();
				}if (e.target.id == "mercredi") {
					mercredi = $('input[name="ouverture"]').val()+"-"+$('input[name="fermeture"]').val();
				}if (e.target.id == "jeudi") {
					jeudi = $('input[name="ouverture"]').val()+"-"+$('input[name="fermeture"]').val();
				}if (e.target.id == "vendredi") {
					vendredi = $('input[name="ouverture"]').val()+"-"+$('input[name="fermeture"]').val();
				}if (e.target.id == "samedi") {
					samedi = $('input[name="ouverture"]').val()+"-"+$('input[name="fermeture"]').val();
				}if (e.target.id == "dimanche") {
					dimanche = $('input[name="ouverture"]').val()+"-"+$('input[name="fermeture"]').val();
				}
		    } else {
		        //console.log("pas Checked" +e.target.id);
		        $("p").remove("#"+e.target.id)
				if (e.target.id == "lundi") {
					lundi = null;
				}if (e.target.id == "mardi") {
					mardi = null;
				}if (e.target.id == "mercredi") {
					mercredi = null;
				}if (e.target.id == "jeudi") {
					jeudi = null;
				}if (e.target.id == "vendredi") {
					vendredi = null;
				}if (e.target.id == "samedi") {
					samedi = null;
				}if (e.target.id == "dimanche") {
					dimanche = null;
				}
		    }
		});
		$('.savecal').click(function(ev){
			ev.preventDefault();
			pause = $('input[name="pausedeb"]').val()+"-"+$('input[name="pausefin"]').val();
		    //console.log(lundi+" / "+mardi+" / "+mercredi+" / "+jeudi+" / "+vendredi+" / "+samedi+" / "+dimanche+" / "+pause);
			 $.ajax({
				 url: '/calendar_dow',
				 data: 'lundi='+lundi+'&mardi='+mardi+'&mercredi='+mercredi+'&jeudi='+jeudi+'&vendredi='+vendredi+'&samedi='+samedi+'&dimanche='+dimanche+'&pause='+pause ,
				 beforeSend: function(req){
					req.setRequestHeader("x-access-token", "<%- locals.session.token %>");
				},
				 type: "POST",
				 success: function(data) {
					//console.log(data);
					localStorage.setItem("datas", JSON.stringify(data));
					document.location = "/agenda";
				 }
			 });
		});
		function update_front_with_errors(tabErr){
		update_front_with_success();
		$.each(tabErr, function (ind, val){
			var elem = $("[name="+ind+"]");
			var title = "";
			//console.log(elem);
			elem.attr("data-toggle", "tooltip");
			$.each(val, function (i, v){
				title += "- "+v+"\n";
			});
			if (elem.is("select[name='cp']")){
				console.log(elem.selectpicker());
				elem.selectpicker();
				elem.selectpicker({title: title}).selectpicker('render');
				var html = '';
    			elem.html(html);
				elem.selectpicker("refresh");
			}else{
				elem.attr("data-title", title);
				elem.attr("data-original-title", title);
			}
		});
		$('[data-toggle="tooltip"]').tooltip('enable');
	}
	function update_front_with_msg(ret){
		var content = "";
		$.each(ret, function (ind, val){
			var elem = $("[data-name="+ind+"]");
			//console.log(elem);
			elem.empty();
			if (ind == "global_msg"){
				$.each(val, function (i, v){
					if (!ret.success[i])
						content += '<div class="error-box margin-top-30"><p>'+v+'</p><div class="small-triangle"></div><div class="small-icon"><i class="jfont">&#xe80f;</i></div></div>';
					else{
						content += '<div class="success-box margin-top-30"><p>'+v+'</p><div class="small-triangle"></div><div class="small-icon"><i class="jfont">&#xe816;</i></div></div>';
					}
				});
				elem.append(content);		
			}
		});
		//$('[data-toggle="tooltip"]').tooltip();
	}
	function update_front_with_success(){
		$('[data-toggle="tooltip"]').tooltip('disable');
		$.each($("[name]"), function (ind, val){
			var elem = $(val);
			if (elem.is("select")){
				elem.selectpicker();
				elem.selectpicker({title: "Sélectionner :"}).selectpicker('render');
				elem.selectpicker("refresh");
			} else{
				$(this).removeAttr("data-title");
				$(this).removeAttr("data-original-title");
			}
			$(this).removeAttr("data-toggle");
		});
		//$('[data-toggle="tooltip"]').tooltip();
		//console.log($('[data-toggle="tooltip"]'));
		
	}
	window.onload = function() {
		var session_data = JSON.parse(localStorage.getItem("datas"));
		//console.log(session_data);
		//console.log(localStorage);
		localStorage.clear();
		if (session_data != null){
			update_front_with_msg(session_data);
			if (session_data.errors !== undefined){
				update_front_with_errors(session_data.errors);
			}
			else{
				update_front_with_success();
			}
		}
	}
</script>
	<script>
    	var user = {};
		var session = {};
		user.id = "<%- locals.session.userId != undefined ? 
			locals.session.userId : "null" %>";
		user.nom = "<%- locals.session.userName ? 
			locals.session.userName : "null" %>";
		user.type = "<%- locals.session.userType ? 
			locals.session.userType : "null" %>";
		session.token = "<%- locals.session.token != undefined ? 
			locals.session.token : "null" %>";	
		//console.log(session);
		session.user = user;
		sessionStorage.setItem("session", JSON.stringify(session));
    </script>
	</body>
</html>